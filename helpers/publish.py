from time import sleep
from random import choice
from google.cloud import pubsub_v1

project_id = "YOUR_PROJECT_ID"
topic_name = "YOUR_SUBSCRIPTION_NAME"

msg1 = b'{"id":"93c64ec5-fd88-4b4c-9b68-da8c67c6a345","projectId":"awesome-project","status":"QUEUED","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.35"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder"},{"name":"busybox","args":["cat","public/index.xml"]},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"id":"frbtools-image","waitFor":["sources-update"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/frbtools","args":["list"],"waitFor":["frbtools-image","test"],"secretEnv":["FIREBASE_TOKEN"]},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 39c64ec5-fd88-4b4c-9b68-da8c67c6a506, repo myworkignrepo, sha1 4975f3f7e2f83ec11b6343c38fe352b054a42fce, ref "],"secretEnv":["FIREBASE_TOKEN"]}],"createTime":"2018-10-30T12:08:52.959889063Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"4975f3f7e2f83ec11b6343c38fe352b054a42fce"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/93c64ec5-fd88-4b4c-9b68-da8c67c6a345?project=244527444365","tags":["event-74003aa3-0542-4fb1-8492-d696731b547e","trigger-f66faddd-a5a2-4540-8cb2-938364a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQAnkpGrdEShtnhv7+4p5DOD28bG8MPRTD86qdTRUoQIuMgTioSVgBPDTPc/YfAlT+XtlGk97RIwBSY3m/rb5dI600wuBKso9Yl4tC14AxYik0N6UOukmCYGcoNKYXCxUu8NrmzvgPiErf5AtyDVtZ5Eve5J9IPKEuniOBU"}}]}'
msg2 = b'{"id":"93c64ec5-fd88-4b4c-9b68-da8c67c6a345","projectId":"awesome-project","status":"WORKING","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.35"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder"},{"name":"busybox","args":["cat","public/index.xml"]},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"id":"frbtools-image","waitFor":["sources-update"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/frbtools","args":["list"],"waitFor":["frbtools-image","test"],"secretEnv":["FIREBASE_TOKEN"]},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 93c64ec5-fd88-4b4c-9b68-da8c67c6a345, repo myworkignrepo, sha1 4975f3f7e2f83ec11b6343c38fe352b054a42fce, ref "],"secretEnv":["FIREBASE_TOKEN"]}],"createTime":"2018-10-30T12:08:52.959889063Z","startTime":"2018-10-30T12:08:53.906568881Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"4975f3f7e2f83ec11b6343c38fe352b054a42fce"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/93c64ec5-fd88-4b4c-9b68-da8c67c6a345?project=244527444365","tags":["event-74003aa3-0542-4fb1-8492-d696731b547e","trigger-f66faddd-a5a2-4540-8cb2-938364a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQAnkpGrdEShtnhv7+4p5DOD28bG8MPRTD86qdTRUoQIuMgTioSVgBPDTPc/YfAlT+XtlGk97RIwBSY3m/rb5dI600wuBKso9Yl4tC14AxYik0N6UOukmCYGcoNKYXCxUu8NrmzvgPiErf5AtyDVtZ5Eve5J9IPKEuniOBU"}}]}'
msg3 = b'{"id":"93c64ec5-fd88-4b4c-9b68-da8c67c6a345","projectId":"awesome-project","status":"SUCCESS","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.35"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash","timing":{"startTime":"2018-10-30T12:08:59.877403930Z","endTime":"2018-10-30T12:09:02.041764293Z"},"pullTiming":{"startTime":"2018-10-30T12:08:59.877403930Z","endTime":"2018-10-30T12:08:59.957752559Z"},"status":"SUCCESS"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash","timing":{"startTime":"2018-10-30T12:09:02.041830970Z","endTime":"2018-10-30T12:09:10.446303883Z"},"pullTiming":{"startTime":"2018-10-30T12:09:02.041830970Z","endTime":"2018-10-30T12:09:04.020599773Z"},"status":"SUCCESS"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update","timing":{"startTime":"2018-10-30T12:09:10.446387647Z","endTime":"2018-10-30T12:09:12.864998252Z"},"pullTiming":{"startTime":"2018-10-30T12:09:10.446387647Z","endTime":"2018-10-30T12:09:10.529518804Z"},"status":"SUCCESS"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash","timing":{"startTime":"2018-10-30T12:09:12.865525375Z","endTime":"2018-10-30T12:09:29.632648598Z"},"pullTiming":{"startTime":"2018-10-30T12:09:12.865525375Z","endTime":"2018-10-30T12:09:13.024504642Z"},"status":"SUCCESS"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test","timing":{"startTime":"2018-10-30T12:09:29.632684717Z","endTime":"2018-10-30T12:09:30.701443132Z"},"pullTiming":{"startTime":"2018-10-30T12:09:29.632684717Z","endTime":"2018-10-30T12:09:29.767671312Z"},"status":"SUCCESS"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder","timing":{"startTime":"2018-10-30T12:09:30.701494817Z","endTime":"2018-10-30T12:09:32.782673730Z"},"pullTiming":{"startTime":"2018-10-30T12:09:30.701494817Z","endTime":"2018-10-30T12:09:30.877577278Z"},"status":"SUCCESS"},{"name":"busybox","args":["cat","public/index.xml"],"timing":{"startTime":"2018-10-30T12:09:32.782830394Z","endTime":"2018-10-30T12:09:36.203968456Z"},"pullTiming":{"startTime":"2018-10-30T12:09:32.782830394Z","endTime":"2018-10-30T12:09:35.033731698Z"},"status":"SUCCESS"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"id":"frbtools-image","waitFor":["sources-update"],"entrypoint":"bash","timing":{"startTime":"2018-10-30T12:09:12.865034684Z","endTime":"2018-10-30T12:10:01.069714188Z"},"pullTiming":{"startTime":"2018-10-30T12:09:12.865034684Z","endTime":"2018-10-30T12:09:13.025240229Z"},"status":"SUCCESS"},{"name":"gcr.io/awesome-project/frbtools","args":["list"],"waitFor":["frbtools-image","test"],"secretEnv":["FIREBASE_TOKEN"],"timing":{"startTime":"2018-10-30T12:10:01.069756259Z","endTime":"2018-10-30T12:10:02.948396513Z"},"pullTiming":{"startTime":"2018-10-30T12:10:01.069756259Z","endTime":"2018-10-30T12:10:01.174621013Z"},"status":"SUCCESS"},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 93c64ec5-fd88-4b4c-9b68-da8c67c6a345, repo myworkignrepo, sha1 4975f3f7e2f83ec11b6343c38fe352b054a42fce, ref "],"secretEnv":["FIREBASE_TOKEN"],"timing":{"startTime":"2018-10-30T12:10:02.948427320Z","endTime":"2018-10-30T12:10:07.545497732Z"},"pullTiming":{"startTime":"2018-10-30T12:10:02.948427320Z","endTime":"2018-10-30T12:10:03.046301932Z"},"status":"SUCCESS"}],"results":{"buildStepImages":["sha256:a8a21761e9ab4a24f4ad39f7bec05b257918f08311c7bf548dbe0e5a795a1c78","","sha256:fad645d593d20fe04bdcba6f05a43d6b0a4c94e63d68870631390fab7da2435c","sha256:d55472f046cb58ec8d363f0c750c8c7a6ecfe88b16f155d0da9906a09382ef99","sha256:0bd8e267677f8c503e5a709562821916a0079c12bfb85753e947fd11a51be684","sha256:0bd8e268077f8c503e5a709562820916a0079c12bfb85753e947fd11a51be684","","sha256:d55872f046cb48ec8d363f0c750c8c7a6ecfe99b16f155d0da9606a09382ef99","sha256:9048da6b0c789834d2a7ee5a011aad1f617d93b0a1341da6b57f3aca9ae7f07d","sha256:9048da6b0c789834d2a7ee5a011aad1f618d93b0a1341da6b57f3aca9ae7f07d"],"buildStepOutputs":[]},"createTime":"2018-10-30T12:08:52.959889063Z","startTime":"2018-10-30T12:08:53.906568881Z","finishTime":"2018-10-30T12:10:08.347141Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"4975f3f7e2f83ec11b6343c38fe352b054a42fce"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/93c64ec5-fd88-4b4c-9b68-da8c67c6a345?project=244527444365","tags":["event-74003aa3-0542-4fb1-8492-d696734b547e","trigger-f66faddd-a5a2-4540-8cb2-938354a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQAnkpGrdCShtnhv7+4p6DOD28bG8MPRTD86qdTRUoQIuMgTioSVgBPDTPd/YfAlT+XtlGk76RIwBSY3m/gb4dI622wuBKso9Yj4tC13AxYik0N6Y0ukmCNGc0NKYXCxUu8NrmzvgOiErf7AtyDVtZ5Eve7R3IRKEvnjOFY"}}],"timing":{"BUILD":{"startTime":"2018-10-30T12:08:59.877360265Z","endTime":"2018-10-30T12:10:07.725358801Z"},"FETCHSOURCE":{"startTime":"2018-10-30T12:08:56.322569566Z","endTime":"2018-10-30T12:08:59.801072050Z"}}}'
msg4 = b'{"id":"624c4c5e-4423-4593-94a8-7b566c948e22","projectId":"awesome-project","status":"QUEUED","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.31"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"waitFor":["sources-update"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder","waitFor":["test"]},{"name":"busybox","args":["cat","public/index.xml"]},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 624c4c5e-4423-4593-94a8-7b566c948e22, repo myworkignrepo, sha1 646aff63ed957521ad19d5b7d5dc77855b11b43d, ref "],"secretEnv":["FIREBASE_TOKEN"]}],"createTime":"2018-10-30T09:11:32.675194179Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"646aff63ed957521ad19d5b7d5dc77855b11b43d"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/624c4c5e-4423-4593-94a8-7b566c948e22?project=244527444365","tags":["event-d1669077-dba3-4963-8749-dbec93bd18db","trigger-f66faddd-a5a2-4540-8cb2-938364a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQAnkpGrdEShtnhv7+4p5DOD28bG8MPRTD86qdTRUoQIuMgTioSVgBPDTPc/YfAlT+XtlGk97RIwBSY3m/rb5dI600wuBKso9Yl4tC14AxYik0N6UOukmCYGcoNKYXCxUu8NrmzvgPiErf5AtyDVtZ5Eve5J9IPKEuniOBU"}}]}'
msg5 = b'{"id":"624c4c5e-4423-4593-94a8-7b566c948e22","projectId":"awesome-project","status":"WORKING","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.31"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"waitFor":["sources-update"],"entrypoint":"bash"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder","waitFor":["test"]},{"name":"busybox","args":["cat","public/index.xml"]},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 624c4c5e-4423-4593-94a8-7b566c948e22, repo myworkignrepo, sha1 646aff63ed957521ad19d5b7d5dc77855b11b43d, ref "],"secretEnv":["FIREBASE_TOKEN"]}],"createTime":"2018-10-30T09:11:32.675194179Z","startTime":"2018-10-30T09:11:33.448230003Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"646aff63ed957521ad19d5b7d5dc77855b11b43d"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/624c4c5e-4423-4593-94a8-7b566c948e22?project=244527444365","tags":["event-d1669077-dba3-4963-8749-dbec93bd18db","trigger-f66faddd-a5a2-4540-8cb2-938364a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQAnkpGrdEShtnhv7+4p5DOD28bG8MPRTD86qdTRUoQIuMgTioSVgBPDTPc/YfAlT+XtlGk97RIwBSY3m/rb5dI600wuBKso9Yl4tC14AxYik0N6UOukmCYGcoNKYXCxUu8NrmzvgPiErf5AtyDVtZ5Eve5J9IPKEuniOBU"}}]}'
msg6 = b'{"id":"624c4c5e-4423-4593-94a8-7b566c948e22","projectId":"awesome-project","status":"FAILURE","source":{"repoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","tagName":"rel-0.31"}},"steps":[{"name":"gcr.io/cloud-builders/gcloud","args":["-c","gcloud container images list-tags gcr.io/awesome-project/hugo --format=json \\u003e gcrimagelist.json\\ngcloud container images list-tags gcr.io/awesome-project/frbtools --format=json \\u003e gcrfrbimglist.json\\n"],"id":"check-images","entrypoint":"bash","timing":{"startTime":"2018-10-30T09:11:39.292916810Z","endTime":"2018-10-30T09:11:41.463822341Z"},"pullTiming":{"startTime":"2018-10-30T09:11:39.292916810Z","endTime":"2018-10-30T09:11:39.376818675Z"},"status":"SUCCESS"},{"name":"python:3.7","args":["-c","python --version\\ngit config --global user.email \\"webadmin@example.com\\"\\ngit config --global user.name \\"webadmin\\"\\npip3 install requests gitpython\\npython ./update.py\\n"],"id":"update","entrypoint":"bash","timing":{"startTime":"2018-10-30T09:11:41.463873628Z","endTime":"2018-10-30T09:11:48.972950271Z"},"pullTiming":{"startTime":"2018-10-30T09:11:41.463873628Z","endTime":"2018-10-30T09:11:43.025646485Z"},"status":"FAILURE"},{"name":"gcr.io/cloud-builders/git","args":["push","-f","https://source.developers.google.com/p/awesome-project/r/myworkignrepo","master","--follow-tags"],"id":"sources-update","status":"QUEUED"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildhugo.txt","IMGNAME=hugo","DCRFILE=Dockerfile-hugo-xtnd","SEARCHSTR=\\"ENV HUGO_VERSION\\""],"args":["./imgbuilder.bash"],"entrypoint":"bash","status":"QUEUED"},{"name":"gcr.io/awesome-project/hugo","args":["--help"],"id":"test","status":"QUEUED"},{"name":"gcr.io/cloud-builders/docker","env":["PROJECT=awesome-project","VRSNFILE=buildfrtls.txt","IMGNAME=frbtools","DCRFILE=Dockerfile-firebase","SEARCHSTR=\\"ENV FRBTOOLS_VERSION\\""],"args":["./imgbuilder.bash"],"waitFor":["sources-update"],"entrypoint":"bash","status":"QUEUED"},{"name":"gcr.io/awesome-project/hugo","id":"site-builder","waitFor":["test"],"status":"QUEUED"},{"name":"busybox","args":["cat","public/index.xml"],"status":"QUEUED"},{"name":"gcr.io/awesome-project/frbtools","args":["--project","awesome-project","--non-interactive","deploy","--only","hosting","--message","Build 624c4c5e-4423-4593-94a8-7b566c948e22, repo myworkignrepo, sha1 646aff63ed957521ad19d5b7d5dc77855b11b43d, ref "],"secretEnv":["FIREBASE_TOKEN"],"status":"QUEUED"}],"results":{"buildStepImages":["sha256:a8a21761e9ab4a24f4ad39f7bec05b257918f08311c7bf548dbe0e5a796a1c67","","","","","","","",""],"buildStepOutputs":[]},"createTime":"2018-10-30T09:11:32.675194179Z","startTime":"2018-10-30T09:11:33.448230003Z","finishTime":"2018-10-30T09:11:49.738830848Z","timeout":"300s","logsBucket":"gs://244527444365.cloudbuild-logs.googleusercontent.com","sourceProvenance":{"resolvedRepoSource":{"projectId":"awesome-project","repoName":"myworkignrepo","commitSha":"646aff63ed957521ad19d5b7d5dc77855b11b43d"}},"buildTriggerId":"f66faddd-a5a2-4540-8cb2-938364a9e62a","options":{"substitutionOption":"ALLOW_LOOSE","logging":"LEGACY"},"logUrl":"https://console.cloud.google.com/gcr/builds/624c4c5e-4423-4593-94a8-7b566c948e22?project=244527444365","tags":["event-d1669077-dba3-4963-8749-dbec93bd19df","trigger-f23faddd-a5c2-4540-8cb2-938564a9e62a"],"secrets":[{"kmsKeyName":"projects/awesome-project/locations/global/keyRings/cloudbuilder/cryptoKeys/firebase-token","secretEnv":{"FIREBASE_TOKEN":"CiQSnkpGrdWShtnhv9+5p5D0D28bG8MPRTD67qdTRUoQIuMgTioFVgBPDTPc/UfAlT+XtlGk6FRIwBSY2m/rb9dI622wuBKso5Yl4tC12DxYik0N6UOukmCYGcoNKYXCxUu7NrmzvgPiErf5000DVtZ5Eve5J9IPKEuniOBY"}}],"timing":{"BUILD":{"startTime":"2018-10-30T09:11:39.292874458Z","endTime":"2018-10-30T09:11:49.093871208Z"},"FETCHSOURCE":{"startTime":"2018-10-30T09:11:35.864230658Z","endTime":"2018-10-30T09:11:39.202951546Z"}}}'
msgs = [msg1, msg2, msg3, msg4, msg5, msg6]
statuses = ['QUEUED', 'WORKING', 'SUCCESS', 'FAILURE']
buildIds = ['93c64ec5-fd88-4b4c-9b68-da8c67c6a345', '624c4c5e-4423-4593-94a8-7b566c948e22']


def callback(message_future):
    # When timeout is unspecified, the exception method waits indefinitely.
    if message_future.exception(timeout=30):
        print('Publishing message on {} threw an Exception {}.'.format(
            topic_name, message_future.exception()))
    else:
        print(message_future.result())


def publish():
    publisher = pubsub_v1.PublisherClient()
    topic_path = publisher.topic_path(project_id, topic_name)

    for n in range(0, 5):
        data = choice(msgs)
        # Data must be a bytestring
        # When you publish a message, the client returns a Future.
        message_future = publisher.publish(topic_path, data=data, status=choice(statuses), buildId=choice(buildIds))
        message_future.add_done_callback(callback)

    print('Published message IDs:')

    # We must keep the main thread from exiting to allow it to process
    # messages in the background.
    while True:
        sleep(60)


if __name__ == '__main__':
    publish()
